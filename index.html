<!DOCTYPE html>
<html lang="zh_TW">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="images/favicon.ico" rel="shortcut icon" />
  <title>2024 葉昱辰個人形象網</title>
  <meta name="description" content="我是葉昱辰，擅長排版、攝影、影片剪輯，110年商業類技藝競賽網頁設計第9名，擔任雲科大第33屆攝影社資訊長。">
  <link rel="stylesheet" href="css/bootstrap.css">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/indexstyle.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.2/gsap.min.js"></script>

  <link href="https://fonts.googleapis.com/css2?family=Audiowide&display=swap" rel="stylesheet">
  <link
    href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100..900&family=Noto+Sans:ital,wght@0,100..900;1,100..900&display=swap"
    rel="stylesheet">
  <!-- Google Search Console -->
  <meta name="google-site-verification" content="EVzyAH-IehWLhGMFf5yQifuMV3oTBZtZlx0eu5eJToY" />
</head>

<body>
  <!-- 過場動畫 -->
  <div id="preloader">
    <div id="loader">
      <img src="images/icon/logo.svg" alt="Logo" class="preloader-logo">
      <div class="progress-text">0 %</div>
    </div>
  </div>

  <!-- Navbar 開頭 -->
  <nav class="navbar navbar-expand-lg navsetting">
    <div class="container-fluid">
      <a class="navbar-brand" href="index.html?skipPreloader=true" 
       onclick="sessionStorage.setItem('fromNavbar', 'true')">
      <img src="images/icon/logo.svg" alt="個人Logo" class="logo">
    </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link" aria-current="page" href="aboutme.html">我的經歷</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" aria-current="page" href="work.html">作品專區</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" aria-disabled="true" href="contact.html">與我聯絡</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- 內容 -->
  <div class="homebigbox">
    <div class="container">
      <div class="row indexRow">
        <div class="col indexLeft">
          <div class="indexInside">
            <img src="images/me.webp" alt="個人形象照" class="profile-image">
            <div class="profile-line"></div>
          </div>
        </div>
        <div class="col rindexRight">
          <div class="indexInside">
            <section class="indexText">
              <h1>
                <span>我</span><span>是</span> <span>葉</span><span>昱</span><span>辰</span>
              </h1>

              <h2><span>I'm</span> <span>Morris</span> <span>Yeh</span><span>.</span></h2>

              <p>擅長排版、攝影、影片剪輯，<br>110 年商業類技藝競賽網頁設計第 9 名，<br>擔任雲科大第 33 屆攝影社資訊長。</p>
              <div class="profile-buttons">
                <button class="btn btnstyle" onclick="window.open('images/履歷.pdf')">簡歷下載</button>
                <button class="btn btnstyle" onclick="window.location.href='aboutme.html'">我的經歷</button>
                <button class="btn btnstyle" onclick="window.location.href='work.html'">作品專區</button>
              </div>

            </section>
            <p style="opacity: 10%; color: white;">v 2.2</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const preloader = document.getElementById("preloader");
      const progressText = document.querySelector(".progress-text");
  
      // 檢查 localStorage 是否已存訪問標記
      const hasVisited = localStorage.getItem("hasVisited");
  
      // 檢查 URL 是否有跳過過場動畫的參數
      const urlParams = new URLSearchParams(window.location.search);
      const skipPreloader = urlParams.get("skipPreloader") === "true";
  
      // 確定是否從內部導航刷新
      const fromInternalNavigation = sessionStorage.getItem("fromNavbar");
  
      if (skipPreloader) {
        // 如果有跳過動畫參數，移除參數
        urlParams.delete("skipPreloader");
        const newUrl = window.location.origin + window.location.pathname + (urlParams.toString() ? `?${urlParams}` : "");
        window.history.replaceState({}, document.title, newUrl); // 更新網址，不刷新頁面
      }
  
      if (!hasVisited) {
        // 情境 1: 首次訪問
        localStorage.setItem("hasVisited", "true"); // 設置訪問標記
        startPreloader(preloader, progressText);
      } else if (fromInternalNavigation) {
        // 情境 2: 從 Navbar 返回首頁，跳過動畫
        sessionStorage.removeItem("fromNavbar"); // 清除標記
        preloader.style.display = "none";
        startGSAPAnimations();
      } else {
        // 情境 3: 手動刷新首頁
        resetPreloader(preloader, progressText);
        startPreloader(preloader, progressText);
      }
    });
  
    // 初始化進度條狀態
    function resetPreloader(preloader, progressText) {
      preloader.style.display = "flex"; // 確保顯示過場動畫
      preloader.style.opacity = "1";
      progressText.textContent = "0%"; // 初始化數字
    }
  
    // 過場動畫邏輯
    function startPreloader(preloader, progressText) {
      let progress = 0;
  
      const interval = setInterval(() => {
        progress += 1;
        progressText.textContent = `${progress}%`;
  
        if (progress >= 100) {
          clearInterval(interval);
  
          // 過場動畫完成後隱藏
          preloader.style.opacity = "0";
          preloader.style.pointerEvents = "none";
  
          setTimeout(() => {
            preloader.style.display = "none";
  
            // 開始 GSAP 動畫
            startGSAPAnimations();
          }, 8); // 等待淡出動畫完成
        }
      }, 7); // 每次更新間隔
    }
  
    function startGSAPAnimations() {
      // indexLeft 動畫
      gsap.timeline()
        .fromTo(".profile-line",
          { scaleY: 0, transformOrigin: "bottom center" },
          { scaleY: 1, duration: 0.8, ease: "power3.out" }
        )
        .fromTo(".profile-image",
          { y: 100, opacity: 0 },
          { y: 0, opacity: 1, duration: 0.8, ease: "power3.out" }, "<");
  
      // indexRight 動畫
      const indexRightTl = gsap.timeline({ delay: 0.5 });
      indexRightTl.fromTo(".indexText h1 span",
        { y: "100%", opacity: 0 },
        { y: "0%", opacity: 1, duration: 0.4, stagger: 0.12, ease: "power3.out" }
      )
        .fromTo(".indexText h2 span",
          { y: "100%", opacity: 0 },
          { y: "0%", opacity: 1, duration: 0.4, stagger: 0.12, ease: "power3.out" }, "-=0.3")
        .fromTo(".indexText p",
          { y: 30, opacity: 0 },
          { y: 0, opacity: 1, duration: 0.5, ease: "power3.out" }, "-=0.2")
        .fromTo(".profile-buttons button",
          { y: 20, opacity: 0 },
          { y: 0, opacity: 1, duration: 0.4, stagger: 0.12, ease: "power3.out" }, "-=0.2");
    }
  </script>  

  <!-- Footer  -->
  <footer>
    <div class="footer">
      <small>版權所有 © 2024 葉昱辰 個人形象網</small>
    </div>
  </footer>

  <script src="js/bootstrap.js"></script>
</body>

</html>